/* 桌宠动画样式 */

/* 状态动画 */
@keyframes petIdle {
  0%, 100% {
    transform: translateY(0) scale(1);
  }
  50% {
    transform: translateY(-3px) scale(1);
  }
}

@keyframes petThinking {
  0%, 100% {
    transform: rotate(-3deg);
  }
  50% {
    transform: rotate(3deg);
  }
}

@keyframes petWorking {
  0%, 100% {
    transform: scale(1);
    box-shadow: 0 18px 36px var(--color_shadow);
  }
  50% {
    transform: scale(1.02);
    box-shadow: 0 20px 40px var(--color_shadow), 0 0 20px var(--color_accent_soft);
  }
}

@keyframes petSuccess {
  0% {
    transform: scale(1);
  }
  25% {
    transform: scale(1.1);
  }
  50% {
    transform: scale(1.05);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes petError {
  0%, 100% {
    transform: translateX(0);
  }
  10%, 30%, 50%, 70%, 90% {
    transform: translateX(-4px);
  }
  20%, 40%, 60%, 80% {
    transform: translateX(4px);
  }
}

@keyframes petBounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-10px);
  }
}

/* 状态类 */
.pet-state-idle {
  animation: petIdle 4s ease-in-out infinite;
}

.pet-state-thinking {
  animation: petThinking 1s ease-in-out infinite;
}

.pet-state-working {
  animation: petWorking 1.5s ease-in-out infinite;
}

.pet-state-success {
  animation: petSuccess 0.5s ease-out;
}

.pet-state-error {
  animation: petError 0.5s ease-out;
}

/* 脸部表情变化 */
.pet-state-thinking .pet-face {
  background: var(--color_muted);
}

.pet-state-working .pet-face {
  background: var(--color_accent_deep);
}

.pet-state-success .pet-face {
  background: #4a9;
}

.pet-state-error .pet-face {
  background: #c55;
}

/* 气泡动画 */
@keyframes bubbleIn {
  0% {
    opacity: 0;
    transform: translate(var(--pet-bubble-offset-x, 0px), calc(var(--pet-bubble-offset-y, 0px) + 10px)) scale(0.8);
  }
  100% {
    opacity: 1;
    transform: translate(var(--pet-bubble-offset-x, 0px), var(--pet-bubble-offset-y, 0px)) scale(1);
  }
}

@keyframes bubbleOut {
  0% {
    opacity: 1;
    transform: translate(var(--pet-bubble-offset-x, 0px), var(--pet-bubble-offset-y, 0px)) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(var(--pet-bubble-offset-x, 0px), calc(var(--pet-bubble-offset-y, 0px) - 10px)) scale(0.8);
  }
}

.pet-bubble {
  transition: all 0.3s ease;
}

.pet-bubble.is-visible {
  /* 注意：不要用 forwards，否则动画会持续覆盖 transform，导致无法用 CSS 调整气泡位移 */
  animation: bubbleIn 0.25s ease-out;
}

.pet-bubble.is-hidden {
  animation: bubbleOut 0.25s ease-out;
}

/* 气泡类型 */
.pet-bubble-info {
  background: var(--color_bubble);
  border-color: var(--color_bubble_border);
}

.pet-bubble-warning {
  background: #fff3cd;
  border-color: #d97757;
}

.pet-bubble-error {
  background: var(--color_alert);
  border-color: #c55;
}

.pet-bubble-success {
  background: #d4edda;
  border-color: #4a9;
}

/* 交互增强 */
.pet {
  cursor: pointer;
  user-select: none;
  transition: filter 0.2s;
}

.pet:hover {
  filter: brightness(1.05);
}

.pet:active {
  filter: brightness(0.95);
}

/* 拖拽时禁用过渡 */
.pet.is-dragging {
  transition: none;
  cursor: grabbing;
}
